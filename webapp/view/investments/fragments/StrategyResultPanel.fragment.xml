<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:f="sap.ui.layout.form"
    xmlns:core="sap.ui.core">
    <Panel id="strategyResultPanelFragment"
        headerText="{i18n>strategyResultPanelTitle}"
        expandable="true"
        expanded="{= !!${strategyResultModel>/hasResults} }"
        class="sapUiTinyMarginTop">
        <content>
            <HBox id="_IDGenHBox2" renderType="Bare" alignItems="Start" width="100%">
                <!-- Columna 1: Información -->
                <VBox id="_IDGenVBox11" width="50%" class="">
                    <f:SimpleForm id="strategyResultInfoFormInFragment"
                        editable="false"
                        layout="ResponsiveGridLayout"
                        title="{i18n>strategyResultInfoTitle}"
                        labelSpanXL="4" labelSpanL="4" labelSpanM="12" labelSpanS="12">
                        <f:content>
                            <Label id="_IDGenLabel10" text="{i18n>strategyResultPeriodLabel}" />
                            <Text id="_IDGenText29" text="{strategyResultModel>/startDate} - {strategyResultModel>/endDate}" />

                            <Label id="_IDGenLabel11" text="{i18n>strategyResultMaParamsLabel}" />
                            <Text id="_IDGenText30" text="{strategyResultModel>/moving_averages/short} / {strategyResultModel>/moving_averages/long}" />

                            <Label id="_IDGenLabel12" text="{i18n>strategyResultOverallSignalLabel}" />
                            <Text id="_IDGenText31" text="{strategyResultModel>/signal}" />

                            <Label id="_IDGenLabel13" text="{i18n>strategyResultNetResultLabel}" design="Bold"/>
                            <ObjectNumber id="_IDGenObjectNumber"
                                number="{
                                    path: 'strategyResultModel>/result',
                                    type: 'sap.ui.model.type.Float', 
                                    formatOptions: { minFractionDigits: 2, maxFractionDigits: 2, groupingEnabled: true }
                                }"
                                emphasized="true"
                                state="{= ${strategyResultModel>/result} > 0 ? 'Success' : (${strategyResultModel>/result} &lt; 0 ? 'Error' : 'None') }" />
                        </f:content>
                    </f:SimpleForm>
                </VBox>
                <!-- Columna 2: Tabla de señales -->
                <VBox id="_IDGenVBox12" width="50%">
                    <Table id="strategySignalsTableInFragment"
                        headerText="{i18n>strategyResultSignalsTableTitle}"
                        items="{strategyResultModel>/signals}"
                        visible="{= !!${strategyResultModel>/signals} &amp;&amp; ${strategyResultModel>/signals}.length > 0}"
                        class="">
                        <columns>
                            <Column id="_IDGenColumn16" width="25%"><Text id="_IDGenText32" text="{i18n>signalDateLabel}" /></Column>
                            <Column id="_IDGenColumn17" width="20%"><Text id="_IDGenText33" text="{i18n>signalTypeLabel}" /></Column>
                            <Column id="_IDGenColumn18" width="25%" hAlign="Right"><Text id="_IDGenText34" text="{i18n>signalPriceLabel}" /></Column>
                            <Column id="_IDGenColumn19" width="30%"><Text id="_IDGenText35" text="{i18n>signalReasoningLabel}" /></Column>
                        </columns>
                        <items>
                            <ColumnListItem id="_IDGenColumnListItem3">
                                <cells>
                                    <Text id="_IDGenText36" text="{path: 'strategyResultModel>date', type: 'sap.ui.model.type.Date', formatOptions: {source: { pattern: 'yyyy-MM-dd' }, style: 'medium'}}" />
                                    <Text id="_IDGenText37" text="{= ${strategyResultModel>type} === 'buy' ? ${i18n>signalTypeBuy} : (${strategyResultModel>type} === 'sell' ? ${i18n>signalTypeSell} : ${strategyResultModel>type}) }" />
                                    <ObjectNumber id="_IDGenObjectNumber1" number="{parts: [{path: 'strategyResultModel>price'}], formatter: '.formatters.formatDecimalNumber'}" emphasized="false" />
                                    <Text id="_IDGenText38" text="{strategyResultModel>reasoning}" />
                                </cells>
                            </ColumnListItem>
                        </items>
                    </Table>
                </VBox>
            </HBox>
        </content>
    </Panel>
</core:FragmentDefinition>